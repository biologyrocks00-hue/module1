<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Video Lesson</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  </head>

  <body>
    <div class="container py-4">
      <!-- Welcome Section -->
      <div class="text-center mb-4">
        <h2 class="fw-bold">Welcome to Your Module 2 Video Lecture üëã</h2>
        <p class="text-secondary mb-0">
          Watch the video below, then answer the exam at the bottom of this
          page.
        </p>
      </div>

      <!-- Video Section -->
      <div class="row justify-content-center my-5">
        <div class="col-lg-10 col-xl-9">
          <div class="ratio ratio-16x9 rounded overflow-hidden shadow-lg">
            <iframe
              width="935"
              height="534"
              src="https://www.youtube.com/embed/ABRXm5lpnag"
              title="Cell Theory vs Modern Cell Theory"
              frameborder="0"
              allow="
                accelerometer;
                autoplay;
                clipboard-write;
                encrypted-media;
                gyroscope;
                picture-in-picture;
                web-share;
              "
              referrerpolicy="strict-origin-when-cross-origin"
              allowfullscreen
            ></iframe>
          </div>
        </div>
      </div>
<hr>
      <!-- Video Section -->
      <div class="row justify-content-center my-5">
        <div class="col-lg-10 col-xl-9 mb-5">
          <div class="ratio ratio-16x9 rounded overflow-hidden shadow-lg">
            <iframe
              width="935"
              height="534"
              src="https://www.youtube.com/embed/NHLK6vWMS1c"
              title="The History of Cell Theory   #cell theory #cell #microscope #history"
              frameborder="0"
              allow="
                accelerometer;
                autoplay;
                clipboard-write;
                encrypted-media;
                gyroscope;
                picture-in-picture;
                web-share;
              "
              referrerpolicy="strict-origin-when-cross-origin"
              allowfullscreen
            ></iframe>
          </div>
        </div>
      </div>

      <div class="bg-dark text-white py-3 my-5">
        <div class="container d-flex justify-content-end">
          <p class="fst-italic px-md-3">
            Please answer the exam after you have studied the lecture
          </p>
          <button
            class="btn btn-success"
            data-bs-toggle="modal"
            data-bs-target="#examModal"
          >
            Answer Exam
          </button>
        </div>
      </div>
    </div>
    <!-- Exam Modal -->
    <div
      class="modal fade"
      id="examModal"
      tabindex="-1"
      data-bs-backdrop="static"
    >
      <div
        class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"
      >
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Module 2 EXAM</h5>
          </div>

          <div class="modal-body">
            <form id="examForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon1"
                      >Name:</span
                    >
                    <input
                      type="text"
                      class="form-control"
                      name="student_name"
                      aria-describedby="basic-addon1"
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-addon1"
                      >Grade and Section:</span
                    >
                    <input
                      type="text"
                      class="form-control"
                      name="grade_n_section"
                      aria-describedby="basic-addon1"
                    />
                  </div>
                </div>
              </div>
              <hr />
              <p class="fst-italic fw-bolder">
                Direction. Research on the ‚ÄúCell Theory‚Äù which tells about the
                discovery of cell. Take note of the scientists and their
                respective works. Choose from the box which scientist gave the
                following statements.
              </p>
              <div class="container-fluid pb-3">
                <div class="d-flex justify-content-between flex-wrap">
                  <div class="card p-2 m-2">
                    <span>Matthias Schleiden</span>
                  </div>
                  <div class="card p-2 m-2">
                    <span>Robert Hooke</span>
                  </div>
                  <div class="card p-2 m-2">
                    <span>Theodor Schwann</span>
                  </div>
                  <div class="card p-2 m-2">
                    <span>Anton van Leeuwenhoek</span>
                  </div>
                  <div class="card p-2 m-2">
                    <span>Rudolf Virchow</span>
                  </div>
                </div>
              </div>
              <div class="input-group mb-3">
                <input type="text" class="form-control" id="eq1" />
                <span class="input-group-text w-100" id="basic-addon1">
                  All cells come from pre-existing cells (1858).
                </span>
              </div>

              <div class="input-group mb-3">
                <input type="text" class="form-control" id="eq2" />
                <span class="input-group-text w-100" id="basic-addon1">
                  All animals are made up of cells (1839).
                </span>
              </div>

              <div class="input-group mb-3">
                <input type="text" class="form-control" id="eq3" />
                <span class="input-group-text w-100" id="basic-addon1">
                  All plants are made up of cells (1838).
                </span>
              </div>

              <div class="input-group mb-3">
                <input type="text" class="form-control" id="eq4" />
                <span class="input-group-text w-100" id="basic-addon1">
                  Tiny living organisms are observed (1676).
                </span>
              </div>

              <div class="input-group mb-3">
                <input type="text" class="form-control" id="eq5" />
                <span class="input-group-text w-100" id="basic-addon1">
                  Thousands of tiny empty chambers in cork are called cells
                  (1665).
                </span>
              </div>
              <hr />

              <div class="container-fluid my-2">
                <p class="fst-italic fw-bolder">
                  Reflection: Answer the following questions.
                </p>
                <div class="mb-3">
                  <p>1. What is the cell theory and what does it state?</p>
                  <textarea
                    class="form-control"
                    placeholder="Leave a comment here"
                    id="r1"
                    style="height: 100px"
                  ></textarea>
                </div>

                <div class="mb-3">
                  <p>
                    2. What do we call the basic generalizations that are
                    accepted by modern science about cells?
                  </p>
                  <textarea
                    class="form-control"
                    placeholder="Leave a answer here"
                    id="r2"
                    style="height: 100px"
                  ></textarea>
                </div>

                <div class="mb-3">
                  <p>
                    3. Among the scientists, who advanced the cell theory with
                    his conclusion that cells could only come from other cells?
                  </p>
                  <textarea
                    class="form-control"
                    placeholder="Leave a answer here"
                    id="r3"
                    style="height: 100px"
                  ></textarea>
                </div>

                <div class="mb-3">
                  <p>4. What discovery is Van Leeuwenhoek noted for?</p>
                  <textarea
                    class="form-control"
                    placeholder="Leave a answer here"
                    id="r4"
                    style="height: 100px"
                  ></textarea>
                </div>

                <div class="mb-3">
                  <p>
                    5. What caused scientists to discover the existence of
                    cells?
                  </p>
                  <textarea
                    class="form-control"
                    placeholder="Leave a answer here"
                    id="r5"
                    style="height: 100px"
                  ></textarea>
                </div>

                <hr />

                <p class="fst-italic fw-bolder">
                  Direction: The figure below indicates events that lead up to
                  the cell theory. Complete the table by filling in the blank
                  spaces.
                </p>
                <div class="table-responsive">
                  <table
                    class="table table-bordered table-hover align-middle text-center"
                    style="min-width: 500px"
                  >
                    <thead class="table-dark">
                      <tr>
                        <th>Date</th>
                        <th>Scientist</th>
                        <th>Discovery</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>1665</td>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="a. Answer"
                            id="t1"
                          />
                        </td>
                        <td>Observed the remains of dead plant cells</td>
                      </tr>

                      <tr>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="b. Year"
                            id="t2"
                          />
                        </td>
                        <td>Anton van Leeuwenhoek</td>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="c. Discovery"
                            id="t3"
                          />
                        </td>
                      </tr>

                      <tr>
                        <td>1838</td>
                        <td>Matthias Schleiden</td>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="d. Discovery"
                            id="t4"
                          />
                        </td>
                      </tr>

                      <tr>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="e. Year"
                            id="t5"
                          />
                        </td>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="f. Scientist"
                            id="t6"
                          />
                        </td>
                        <td>Stated that all animals are made of cells</td>
                      </tr>

                      <tr>
                        <td>1858</td>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="g. Scientist"
                            id="t7"
                          />
                        </td>
                        <td>
                          <input
                            type="text"
                            class="form-control"
                            placeholder="h. Discovery"
                            id="t8"
                          />
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <hr />
                <p class="fst-italic">
                  <strong>Performance Task:</strong> Research on the theory of
                  spontaneous generation or theory of abiogenesis by Stanley
                  Miller and Francesco Redi and Louis Pasteur's experiment.
                  Compare the two theories on the origin of life.
                </p>
              </div>
            </form>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-success" id="submitExam">
              Submit Answers
            </button>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      const correctAnswers = {
        q1: "all living things are composed of one or more cells",
        q2: "the cell is the basic unit of life",
        q3: "all cells arise from pre-existing cells",
      };

      function normalize(text) {
        return text.toLowerCase().replace(/\s+/g, " ").trim();
      }

      function checkAnswer(inputId, resultId) {
        const userAnswer = normalize(document.getElementById(inputId).value);
        const correctAnswer = normalize(correctAnswers[inputId]);
        const resultDiv = document.getElementById(resultId);

        if (userAnswer === correctAnswer) {
          resultDiv.innerHTML =
            "<span class='text-success fw-bold'>Correct ‚úî</span>";
        } else {
          resultDiv.innerHTML =
            "<span class='text-danger fw-bold'>Incorrect ‚úò</span>";
        }
      }
    </script>

    <script>
      $(document).ready(function () {
        const correctAnseq = {
          eq1: "Rudolf Virchow ",
          eq2: "Theodor Schwann",
          eq3: "Matthias Schleiden",
          eq4: "Anton van Leeuwenhoek",
          eq5: "Rudolf Virchow",
        };

        const correctAnst = {
          ct1: "Robert Hooke",
          ct2: "1676",
          ct3: "Observed living animalcules",
          ct4: "Proved all plants are made of cells",
          ct5: "Theodor Schwann",
          ct6: "1839",
          ct7: "Rudolf Virchow",
          ct8: "Concluded cells come from existing cells",
        };

        const eqQuestions = {
          eqQues1: "All cells come from pre-existing cells (1858).",
          eqQues2: "All animals are made up of cells (1839).",
          eqQues3: "All plants are made up of cells (1838).",
          eqQues4: "Tiny living organisms are observed (1676).",
          eqQues5:
            "Thousands of tiny empty chambers in cork are called cells (1665).",
        };

        const rQuestions = {
          rQues1: "What is the cell theory and what does it state?",
          rQues2:
            "What do we call the basic generalizations that are accepted by modern science about cell?",
          rQues3:
            "Among the scientists, who advanced the cell theory with his conclusion that cells could only come from other cells?",
          rQues4: "What discovery is Van Leeuwenhoek noted for?",
          rQues5: "What caused scientists to discover the existence of cells?",
        };

        $("#submitExam").click(function () {
          const eqAnswers = {
            ans1: $('input[id="eq1"]').val() || "No answer",
            ans2: $('input[id="eq2"]').val() || "No answer",
            ans3: $('input[id="eq3"]').val() || "No answer",
            ans4: $('input[id="eq4"]').val() || "No answer",
            ans5: $('input[id="eq5"]').val() || "No answer",
          };

          const name = $('input[name="student_name"]').val();
          const grade_n_section = $('input[name="grade_n_section"]').val();

          const rAnswers = {
            r1: $('textarea[id="r1"]').val() || "No answer",
            r2: $('textarea[id="r2"]').val() || "No answer",
            r3: $('textarea[id="r3"]').val() || "No answer",
            r4: $('textarea[id="r4"]').val() || "No answer",
            r5: $('textarea[id="r5"]').val() || "No answer",
          };

          const tAnswers = {
            t1: $('input[id="t1"]').val() || "No answer",
            t2: $('input[id="t2"]').val() || "No answer",
            t3: $('input[id="t3"]').val() || "No answer",
            t4: $('input[id="t4"]').val() || "No answer",
            t5: $('input[id="t5"]').val() || "No answer",
            t6: $('input[id="t6"]').val() || "No answer",
            t7: $('input[id="t7"]').val() || "No answer",
            t8: $('input[id="t8"]').val() || "No answer",
          };

          /* =======================
         CREATE PDF
      ======================= */
          const doc = new window.jspdf.jsPDF("p", "mm", "a4");

          const pageHeight = doc.internal.pageSize.height;
          const bottomMargin = 20;

          let y = 35;

          function checkPageBreak(extra = 0) {
            if (y + extra > pageHeight - bottomMargin) {
              doc.addPage();
              y = 20;
            }
          }

          /* =======================
         HEADER
      ======================= */
          doc.setFont("helvetica", "bold");
          doc.setFontSize(12);
          doc.setTextColor(0);

          doc.text(`Name: ${name}`, 20, 20);
          doc.text(`Grade and Section: ${grade_n_section}`, 20, 26);

          const today = new Date();
          const formattedDate = today.toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric",
          });

          doc.text(`Date: ${formattedDate}`, 130, 20);

          /* =======================
         EQ QUESTIONS LOOP
      ======================= */
          for (let i = 1; i <= 5; i++) {
            const eqans = "ans" + i; //answer
            const queseq = "eqQues" + i; //questions
            const cAns = "eq" + i; //correct answer

            checkPageBreak(25);

            // Question
            doc.setFont("helvetica", "bold");
            doc.setTextColor(0);
            const qText = doc.splitTextToSize(
              `${i}. ${eqQuestions[queseq]}`,
              180,
            );
            doc.text(qText, 14, y);
            y += qText.length * 6;

            // Student answer
            checkPageBreak(10);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(0, 0, 128);
            doc.text(`Your answer: ${eqAnswers[eqans]}`, 16, y);
            y += 5;

            // Correct answer
            checkPageBreak(10);
            const correctText = Array.isArray(correctAnseq[cAns])
              ? correctAnseq[cAns].join(" or ")
              : correctAnseq[cAns];

            doc.setTextColor(0, 128, 0);
            doc.text(`Correct answer: ${correctText}`, 16, y);
            y += 5;

            // Check correctness
            const isCorrect = Array.isArray(correctAnseq[cAns])
              ? correctAnseq[cAns].includes(eqAnswers[eqans])
              : eqAnswers[eqans] === correctAnseq[cAns];

            // Result box
            checkPageBreak(12);
            const mark = isCorrect ? "Correct" : "Wrong";
            const color = isCorrect ? [0, 180, 0] : [200, 0, 0];

            doc.setDrawColor(...color);
            doc.setFillColor(...color);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(255);
            doc.rect(16, y, 40, 6, "FD");
            doc.text(mark, 18, y + 4);
            y += 12;

            // Separator
            doc.setDrawColor(150);
            doc.line(14, y, 196, y);
            y += 6;
          }

          /* =======================
   EQ SCORE (FIXED)
======================= */
          let score = 0;
          const totalQuestions = 5;

          for (let i = 1; i <= totalQuestions; i++) {
            const answerKey = "ans" + i;
            const correctKey = "eq" + i;

            const studentAnswer = eqAnswers[answerKey];
            const correctAnswer = correctAnseq[correctKey];

            const isCorrect = Array.isArray(correctAnswer)
              ? correctAnswer.includes(studentAnswer)
              : studentAnswer === correctAnswer;

            if (isCorrect) score++;
          }

          doc.setFont("helvetica", "bold");
          doc.setFontSize(12);
          doc.setTextColor(255, 0, 0);
          doc.text(`Score: ${score} / ${totalQuestions}`, 14, y);
          // Separator
          doc.setDrawColor(150);
          doc.line(14, y + 6, 196, y + 6);

          y += 20;

          /* =======================
   R QUESTIONS LOOP WITH KEYWORD SCORING & DISPLAY
======================= */
          const rKeywords = {
            r1: [
              "cell theory",
              "all living things",
              "composed",
              "cells",
              "state",
            ],
            r2: [
              "generalizations",
              "accepted",
              "science",
              "cells",
              "principles",
            ],
            r3: ["Virchow", "pre-existing", "cells", "conclusion", "come from"],
            r4: [
              "Van Leeuwenhoek",
              "discovery",
              "microscope",
              "organisms",
              "animalcules",
            ],
            r5: ["scientists", "discovery", "cells", "microscope", "observed"],
          };

          for (let i = 1; i <= 5; i++) {
            const rans = "r" + i; // student answer
            const quesr = "rQues" + i; // question

            checkPageBreak(25);

            // Question
            doc.setFont("helvetica", "bold");
            doc.setTextColor(0);
            const qText = doc.splitTextToSize(
              `${i}. ${rQuestions[quesr]}`,
              180,
            );
            doc.text(qText, 14, y);
            y += qText.length * 7;

            // Student answer
            checkPageBreak(10);
            const studentAnswer = rAnswers[rans];
            doc.setFont("helvetica", "normal");
            doc.setTextColor(0, 0, 128);
            doc.text(`Your answer: ${studentAnswer}`, 16, y);
            y += 6;

            // Display correct keywords
            const keywords = rKeywords[rans];
            const keywordsText = "Keywords: " + keywords.join(", ");
            checkPageBreak(10);
            doc.setFont("helvetica", "italic");
            doc.setTextColor(0, 128, 0);
            const kwText = doc.splitTextToSize(keywordsText, 180);
            doc.text(kwText, 16, y);
            y += kwText.length * 6;

            // Calculate score based on keywords
            let matchCount = 0;
            const normalizedAnswer = studentAnswer.toLowerCase();
            keywords.forEach((kw) => {
              if (normalizedAnswer.includes(kw.toLowerCase())) matchCount++;
            });
            const score = Math.round((matchCount / keywords.length) * 5); // max 5 points

            // Display score
            checkPageBreak(6);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(255, 0, 0);
            doc.text(`Score: ${score} / 5`, 16, y);
            y += 12;

            // Separator
            checkPageBreak(6);
            doc.setDrawColor(150);
            doc.line(14, y, 196, y);
            y += 6;
          }

          /* =======================
         T QUESTIONS LOOP
      ======================= */
          for (let i = 1; i <= 5; i++) {
            const tans = "t" + i; //answer
            const cAnst = "ct" + i; //correct answer

            checkPageBreak(25);

            // Student answer
            checkPageBreak(10);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(0, 0, 128);
            doc.text(`${i}.) Your answer: ${tAnswers[tans]}`, 16, y);
            y += 5;

            // Correct answer
            checkPageBreak(10);
            const correctText = Array.isArray(correctAnst[cAnst])
              ? correctAnst[cAnst].join(" or ")
              : correctAnst[cAnst];

            doc.setTextColor(0, 128, 0);
            doc.text(`Correct answer: ${correctText}`, 16, y);
            y += 5;

            // Check correctness
            const isCorrect = Array.isArray(correctAnst[cAnst])
              ? correctAnst[cAnst].includes(tAnswers[tans])
              : tAnswers[tans] === correctAnst[cAnst];

            // Result box
            checkPageBreak(12);
            const mark = isCorrect ? "Correct" : "Wrong";
            const color = isCorrect ? [0, 180, 0] : [200, 0, 0];

            doc.setDrawColor(...color);
            doc.setFillColor(...color);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(255);
            doc.rect(16, y, 40, 6, "FD");
            doc.text(mark, 18, y + 4);
            y += 12;

            // Separator
            doc.setDrawColor(150);
            doc.line(14, y, 196, y);
            y += 6;
          }

          /* =======================
   T SCORE (FIXED)
======================= */
          let score1 = 0;
          const totalQuestions1 = 8;

          for (let i = 1; i <= totalQuestions1; i++) {
            const answerKey1 = "t" + i;
            const correctKey1 = "ct" + i;

            const studentAnswer1 = tAnswers[answerKey1];
            const correctAnswer1 = correctAnst[correctKey1];

            const isCorrect1 = Array.isArray(correctAnswer1)
              ? correctAnswer1.includes(studentAnswer1)
              : studentAnswer1 === correctAnswer1;

            if (isCorrect1) score1++;
          }

          doc.setFont("helvetica", "bold");
          doc.setFontSize(12);
          doc.setTextColor(255, 0, 0);
          doc.text(`Score: ${score1} / ${totalQuestions1}`, 14, y + 6);

          // Separator
          doc.setDrawColor(150);
          doc.line(14, y + 6, 196, y + 6);

          /* =======================
         SAVE & CLOSE
      ======================= */
          doc.save("Module 2.pdf");
          $("#examModal").modal("hide");
        });
      });
    </script>
  </body>
</html>
